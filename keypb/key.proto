// This file defines a storage format for an encrypted key file.  A key file is
// symmetrically encrypted based on a passphrase.

syntax = "proto3";

package keypb;

// Keyfile is the storage format for a key file. The keys in a file are
// encrypted with AES-256 using a key derived from a passphrase using scrypt.
message Keyfile {
  // The key in the file is encrypted with AES-256, the key for which is
  // generated by the scrypt algorithm from the passphrase.
  Key key = 1;

  // A Key is stored as an array of bytes that has been encrypted in CTR mode.
  message Key {
    bytes data = 1;  // encrypted secret (see below)
    bytes init = 2;  // initialization vector
    bytes salt = 3;  // key generation salt
  }

  // The format of the input data prior to encryption is:
  //   | 4-byte CRC (IEEE) | input data ... |
  //
  // The CRC is stored in network byte order.
}
